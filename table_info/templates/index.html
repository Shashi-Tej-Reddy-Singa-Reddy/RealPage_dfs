<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Schema Viewer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <header>
        <!-- <a href="arch.html">View Architecture</a> -->
        <h1>Database Schema Viewer üêç</h1>
        <div class="controls">
            <input type="text" id="searchInput" placeholder="Search tables or columns...">
        </div>
    </header>

    <main id="schemaContainer">
        <div class="placeholder">
            <h2>Loading Schema...</h2>
            <p>Please wait a moment.</p>
        </div>
    </main>

    <section class="diagram-section">
        <h2>Table Relationship Diagram</h2>
        <p>This diagram shows the relationships between key tables in the screening process, inferred from data fix scripts.</p>
        <div class="mermaid">
            graph TD
                subgraph "Screening Process Data Flow"
                    ScreeningApplicantGroup["ScreeningApplicantGroup<br/><i>(Central hub for a screening request)</i>"] -- "apgID (1-to-many)" --> ScreeningApplicant["ScreeningApplicant<br/><i>(Details for each individual applicant)</i>"]
                    ScreeningApplicantGroup -- "apgID (1-to-many)" --> ScreeningXgDecision["ScreeningXgDecision<br/><i>(Stores the final screening decision)</i>"]
                    ScreeningApplicantGroup -- "asrAppGID (1-to-many)" --> appscreeningresults["appscreeningresults<br/><i>(Summary of screening results)</i>"]
                    ScreeningApplicantGroup -- "apgID (1-to-many)" --> screeningactivitylog["screeningactivitylog<br/><i>(History of events for the screening)</i>"]

                    ScreeningApplicant -- "appID (1-to-many)" --> screeningxglog["screeningxglog<br/><i>(Logs from external services, e.g., errors)</i>"]
                    ScreeningApplicant -- "AppID (1-to-many)" --> screeningxgxml["screeningxgxml<br/><i>(Raw XML data from external services like credit reports)</i>"]

                    ScreeningXgDecisionType["ScreeningXgDecisionType<br/><i>(Lookup table for decision types, e.g., 'Approved')</i>"] -- "dtID (1-to-many)" --> ScreeningXgDecision
                end

                style ScreeningApplicantGroup fill:#f9f,stroke:#333,stroke-width:2px
                style ScreeningApplicant fill:#ccf,stroke:#333,stroke-width:2px
                style ScreeningXgDecision fill:#cfc,stroke:#333,stroke-width:2px
                style appscreeningresults fill:#cfc,stroke:#333,stroke-width:2px
                style screeningactivitylog fill:#ffc,stroke:#333,stroke-width:2px
                style screeningxglog fill:#ffc,stroke:#333,stroke-width:2px
                style screeningxgxml fill:#ffc,stroke:#333,stroke-width:2px
                style ScreeningXgDecisionType fill:#fcf,stroke:#333,stroke-width:2px
        </div>
    </section>

    <footer>
        <p>Powered by Python & Flask. Starred items are saved in your browser.</p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({ startOnLoad: true });</script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>
</html>